
四、数据采集服务器
 1.用例描述
  数据采集服务器通过网络接收数据采集客户机上传的匹配日志记录，保存到数据库中。
  
 2.参与者
  系统管理员、数据采集服务器、服务器套接字、客户线程、日志队列、存储线程、数据访问对象、数据库
  用例图：09_server_usecase.pdf
  
  系统管理员：操作数据采集服务器
  数据采集服务器:1）创建存储线程 监视日志队列的变化
                 2）创建服务器套接字 侦听客户机的连接请求 
                    一旦有客户机发起连接并成功，由服务器套接字创建一个具体的客户线程，和客户通信，客户线程把客户机上传的匹配日志接收到并放入日志队列，存储线程负责监视日志队列，把日志队列中的每一条新增的匹配日志读取出来交给数据访问对象，再经由数据访问对象插入到数据库。

 3.基本事件流
  1）接收匹配日志
   A.建立服务器侦听套接字；
   B.等待并接受客户机的连接请求；
   C.该客户机创建客户线程，接收其上传的匹配日志记录；
   D.将接收到的匹配日志记录压入日志队列。
  2）保存匹配日志
   A.创建存储线程
   B.创建数据访问对象，建立与数据库的连接；
   C.监视日志队列，从中弹出匹配日志记录；
   D.将匹配日志记录通过数据访问日志对象保存到数据库中；
   E.销毁数据访问对象，关闭与数据库的连接。
   涉及提示：
   线程封装、基于条件变量的线程同步
   
   客户线程 ----->  日志队列 <------ 存储线程   ：生产者消费者模式
    生产者                            消费者
   客户线程会因为 满 而等待
   存储线程会因为 空 而等待
   解决方式：条件变量   

 4.异常事件流
   1）访问数据库失败：终止采集
   2）网络通信失败：终止采集
   3）创建线程失败：终止采集
   

 5.前置条件
  1）侦听端口和地址绑定；
  2）数据库的用户名和口令。

 6.后置条件
  数据库中匹配日志记录

 7.类图、时序图和活动图/状态图
  10_server_data.pdf       \
  11_server_exception.pdf   > 类图
  12_server_class.pdf      /
  13_server_sequence.pdf   -- 时序图
  
  10_server_data.pdf

  11_server_exception.pdf
                
  12_server_class.pdf
 

 8.编写代码
  server/
























